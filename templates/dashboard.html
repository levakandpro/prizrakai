<!-- –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç ‚Äî PRIZRAK</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <header class="site-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="dashboard-title">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>
        <img src="/static/icons/dashboard-icon.svg" alt="–ö–∞–±–∏–Ω–µ—Ç" class="dashboard-icon">
      </div>
      <a href="/" class="btn btn-home">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>
  </header>

  <div class="dashboard-container">
    <section class="dashboard-card">
      <h2 class="card-title">üíº –¢–µ–∫—É—â–∏–π —Ç–∞—Ä–∏—Ñ</h2>
      <div class="tariff-info">
        <p><strong>–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> {{ user.tariff_name }}</p>
        <p><strong>–ì–µ–Ω–µ—Ä–∞—Ü–∏–π –≤ –¥–µ–Ω—å:</strong> {{ user.daily_limit }}</p>
        <p><strong>–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è:</strong> –¥–æ {{ user.tariff_expires }}</p>
        <p><strong>–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π:</strong> {{ user.days_left }}</p>
        <a href="/update_tariff" class="btn-tariff-upgrade">‚ö° –û–±–Ω–æ–≤–∏—Ç—å —Ç–∞—Ä–∏—Ñ</a>
      </div>
    </section>

    <section class="dashboard-card">
      <h2 class="card-title">üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∫—Ä–∏–Ω–∞ –æ–ø–ª–∞—Ç—ã</h2>
      <form id="uploadForm" enctype="multipart/form-data">
        <input type="text" name="name" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π / –∏–º—è">
        <input type="file" name="screenshot">
        <button type="submit" class="btn-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
      </form>
    </section>

    <section class="dashboard-card">
      <h2 class="card-title">üìú –ü–ª–∞—Ç—ë–∂–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è</h2>
      <table class="history-table">
        <thead>
          <tr>
            <th>–î–∞—Ç–∞</th>
            <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
            <th>–§–∞–π–ª</th>
            <th>–°—Ç–∞—Ç—É—Å</th>
          </tr>
        </thead>
        <tbody>
          {% for p in payments %}
          <tr>
            <td>{{ p.date.split('T')[0] }}</td>
            <td>{{ p.name }}</td>
            <td><a href="/static/uploads/{{ p.filename }}" target="_blank">üìé</a></td>
            <td>{{ p.status }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
  </div>

  <footer class="dashboard-footer">
    <button class="footer-btn profile-btn" onclick="toggleProfileModal()">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
    <button class="footer-btn tariff-btn" onclick="toggleTariffModal()">üíé –ú–æ–π —Ç–∞—Ä–∏—Ñ</button>
    <form method="POST" action="/delete_account" onsubmit="return confirm('–í—ã —Ç–æ—á–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –≠—Ç–æ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.')" style="margin: 0;">
      <button class="footer-btn danger-btn" type="submit">üóë –£–¥–∞–ª–∏—Ç—å</button>
    </form>
  </footer>

  <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
  <div id="profileModal" class="glass-modal">
    <div class="glass-profile-card">
      <button class="close-btn" onclick="document.getElementById('profileModal').style.display='none'">‚úñ</button>
      <div class="avatar-row">
<img src="{{ url_for('static', filename='icons/ava.png') }}" alt="avatar" class="profile-avatar">

        <div class="user-info">
          <h3>{{ user.name }}</h3>
          <p>{{ user.email }}</p>
          <p><strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> {{ user.registered_at }}</p>
          <p><strong>ID:</strong> {{ user.id }}</p>
        </div>
      </div>
      <form action="/logout" method="get">
        <button class="footer-btn danger-btn" type="submit">üö™ –í—ã–π—Ç–∏</button>
      </form>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ —Ç–∞—Ä–∏—Ñ–∞ -->
<div id="tariffModal" class="glass-modal">
  <div class="glass-profile-card">
    <button class="close-btn" onclick="document.getElementById('tariffModal').classList.remove('active')">‚úñ</button>
    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 24px;">
      <img src="/static/icons/diamond.svg" alt="–∏–∫–æ–Ω–∫–∞ —Ç–∞—Ä–∏—Ñ–∞" style="width: 24px; height: 24px;">
      <h3 style="margin: 0; font-size: 20px;">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ</h3>
    </div>

    <div class="tariff-options">
      <div class="tariff-card free">
        <div style="display: flex; align-items: center; gap: 10px;">
          <img src="/static/icons/free.svg" alt="free" style="width: 20px; height: 20px;">
          <h4 style="margin: 0;">FREE / –ë–ï–°–ü–õ–ê–¢–ù–´–ô</h4>
        </div>
        <ul>
          <li>10 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –≤ –¥–µ–Ω—å</li>
          <li>–î–æ 5000 —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é</li>
          <li>0 $ / –Ω–∞–≤—Å–µ–≥–¥–∞</li>
        </ul>
      </div>

      <div class="tariff-card premium">
        <div style="display: flex; align-items: center; gap: 10px;">
          <img src="/static/icons/high-quality.svg" alt="premium" style="width: 20px; height: 20px;">
          <h4 style="margin: 0;">PRIZRAK PREMIUM</h4>
        </div>
        <ul>
          <li>–ë–ï–ó–õ–ò–ú–ò–¢–ù–ê–Ø –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</li>
          <li>–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</li>
          <li>$35 / –º–µ—Å—è—Ü</li>
        </ul>
<a href="/update_tariff" class="btn-tariff-upgrade">
  <img src="/static/icons/award.svg" alt="–æ–±–Ω–æ–≤–∏—Ç—å" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 6px;">
  –û–±–Ω–æ–≤–∏—Ç—å –¥–æ <span class="premium-gold">PREMIUM</span>
</a>

      </div>
    </div>
  </div>
</div>


<script>
  function toggleProfileModal() {
    document.getElementById("profileModal").classList.add("active");
  }

  function toggleTariffModal() {
    document.getElementById("tariffModal").classList.add("active");
  }

  document.addEventListener("DOMContentLoaded", () => {
    const uploadForm = document.getElementById("uploadForm");
    if (uploadForm) {
      uploadForm.onsubmit = async (e) => {
        e.preventDefault();
        const formData = new FormData(e.target);
        const res = await fetch("/submit_payment", {
          method: "POST",
          body: formData
        });
        const json = await res.json();
        alert(json.success ? "–°–∫—Ä–∏–Ω —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω" : "–û—à–∏–±–∫–∞: " + json.message);
      };
    }

    // –ö–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
    document.querySelectorAll(".close-btn").forEach(btn => {
      btn.onclick = () => {
        document.getElementById("profileModal").classList.remove("active");
        document.getElementById("tariffModal").classList.remove("active");
      };
    });
  });
</script>


</body>
</html>
